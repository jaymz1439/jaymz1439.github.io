



<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>
      
Helm | Chart

    </title>

    







<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1.0">


<meta name="description" content="阐述chart格式，并提供使用Helm构建chart的基本指导。">


<meta property="og:title" content="Chart">
<meta property="og:title" content="Chart">
<meta property="og:url" content="https://zou-zongming.github.io/zh/docs/topics/charts/">
<meta property="og:description" content="阐述chart格式，并提供使用Helm构建chart的基本指导。" />

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zou-zongming.github.io/img/og-image.png">
<meta name="twitter:title" content="Helm | Chart">
<meta name="twitter:description" content="阐述chart格式，并提供使用Helm构建chart的基本指导。">

<meta name="google-site-verification" content="dCa3wS47cErhx0IpaxbB85NfcOP-vFxevknVk6fzf5I">

<link rel="icon" href="https://zou-zongming.github.io/img/favicon-152.png" type="image/x-icon">
<link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon-precomposed.png">














<link rel="stylesheet" href="/css/style.bb9a3f16cd8b057bc29c79565ae0d4a0d40d2088a9939d614209a479d640b7bb.css" integrity="sha256-u5o/Fs2LBXvCnHlWWuDUoNQNIIipk51hQgmkedZAt7s=">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />





  </head>

  
    <body id="landing" class="zh"></body>
  
    

<div id="helm" class="page-docs page-wrapper page-docs-list">
  <header>
    
    



<nav class="navbar navbar-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid is-vcentered">
    <div class="navbar-brand">
      <a href="/">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 304 351"><title>Helm</title>
<mask id="a" fill="#fff">
<path d="m0 0h313.303155v159.864865h-313.303155z" fill="#fff" fill-rule="evenodd"/>
</mask>
<mask id="b" fill="#fff">
<path d="m0 0h313.303155v159.864865h-313.303155z" fill="#fff" fill-rule="evenodd"/>
</mask>
<g fill="none" fill-rule="evenodd" transform="translate(-11 -51)">
<path d="m11.6785714 189h19.7858357v26.789h23.9037v-26.789h19.7858358v75.25h-19.7858358v-28.695333h-23.9037v28.695333h-19.7858357zm86.1738429 75.25v-75.25h46.8030427v16.354333h-27.017207v12.240667h23.9037v16.655333h-23.9037v13.846h27.017207v16.153667zm68.4971567 0v-75.25h19.785836v55.384h27.117643v19.866zm77.536372-75.25 30.733328 27.892667 30.632893-27.892667h8.938779v75.25h-19.886272v-38.628333l-19.6854 17.959666-19.785835-17.859333v38.528h-19.886272v-75.25z" fill="#0f1689"/>
<g transform="matrix(1 0 0 -1 11.958136 455)">
<g fill="#0f1689" mask="url(#a)">
<path d="m203.460676 95.6875425c6.93631 0 12.559301-14.8092194 12.559301-33.0773172s-5.622991-33.0773172-12.559301-33.0773172c-6.936311 0-12.559301 14.8092194-12.559301 33.0773172s5.62299 33.0773172 12.559301 33.0773172z" transform="matrix(.81915204 .57357644 -.57357644 .81915204 111.870091 -51.706556)"/>
<path d="m30.1423223 95.6875425c6.9363104 0 12.559301-14.8092194 12.559301-33.0773172s-5.6229906-33.0773172-12.559301-33.0773172-12.5593009 14.8092194-12.5593009 33.0773172 5.6229905 33.0773172 12.5593009 33.0773172z" transform="matrix(-.81915204 .57357644 .57357644 .81915204 58.084611 47.704768)"/>
<path d="m116.732815 66.2752676c6.936311 0 12.559301-14.8092193 12.559301-33.0773172 0-18.2680978-5.62299-33.07731713-12.559301-33.07731713-6.93631 0-12.559301 14.80921933-12.559301 33.07731713 0 18.2680979 5.622991 33.0773172 12.559301 33.0773172z" transform="matrix(-1 0 0 1 272.628524 53.670762)"/>
</g>
<path d="m251.467006 173.099849c-20.230076-33.609969-56.889565-56.067908-98.755776-56.067908-40.720798 0-76.5158766 21.245901-97.0586959 53.334588m2.1981107 129.169534c20.8403036 30.232701 55.5559042 50.026591 94.8605852 50.026591 39.376099 0 74.146424-19.865887 94.974049-50.191495" mask="url(#a)" stroke="#0f1689" stroke-width="20"/>
</g>
<g transform="translate(11.958136)">
<g fill="#0f1689" mask="url(#b)">
<path d="m203.460676 95.6875425c6.93631 0 12.559301-14.8092194 12.559301-33.0773172s-5.622991-33.0773172-12.559301-33.0773172c-6.936311 0-12.559301 14.8092194-12.559301 33.0773172s5.62299 33.0773172 12.559301 33.0773172z" transform="matrix(.81915204 .57357644 -.57357644 .81915204 111.870091 -54.166016)"/>
<path d="m30.1423223 95.6875425c6.9363104 0 12.559301-14.8092194 12.559301-33.0773172s-5.6229906-33.0773172-12.559301-33.0773172-12.5593009 14.8092194-12.5593009 33.0773172 5.6229905 33.0773172 12.5593009 33.0773172z" transform="matrix(-.81915204 .57357644 .57357644 .81915204 58.084611 45.245308)"/>
<path d="m116.732815 66.2752676c6.936311 0 12.559301-14.8092193 12.559301-33.0773172 0-18.2680978-5.62299-33.07731713-12.559301-33.07731713-6.93631 0-12.559301 14.80921933-12.559301 33.07731713 0 18.2680979 5.622991 33.0773172 12.559301 33.0773172z" transform="matrix(-1 0 0 1 272.628524 51.211302)"/>
</g>
<path d="m251.467006 170.64039c-20.230076-33.609969-56.889565-56.067908-98.755776-56.067908-40.720798 0-76.5158766 21.2459-97.0586959 53.334587m2.1981107 129.169534c20.8403036 30.232702 55.5559042 50.026591 94.8605852 50.026591 39.376099 0 74.146424-19.865886 94.974049-50.191494" mask="url(#b)" stroke="#0f1689" stroke-width="20"/>
</g>
</g>
</svg>
      </a>
    </div>

    
    <div class="navbar-menu is-centered" id="navMenuDocumentation">
      
        
          <a href="/zh/" class="navbar-item">
            首页
          </a>
        
      
        
          <a href="/zh/docs" class="navbar-item">
            文档
          </a>
        
      
        
          <a href="https://hub.helm.sh/" class="navbar-item external" target="_blank">
            应用中心 <span class="icon"><i class="mdi mdi-open-in-new"></i></span>
          </a>
        
      
        
          <a href="https://helm.sh/blog" class="navbar-item external" target="_blank">
            博客 <span class="icon"><i class="mdi mdi-open-in-new"></i></span>
          </a>
        
      
        
          <a href="https://github.com/helm/community" class="navbar-item external" target="_blank">
            社区 <span class="icon"><i class="mdi mdi-open-in-new"></i></span>
          </a>
        
      
    </div>

    <div class="navbar-end is-hidden-mobile">
      <ul class="is-pulled-right">
        





  <li class="versioner l18ner navbar-item has-dropdown is-right is-hoverable">
    <a data-dropdown="drop1" aria-controls="drop1" aria-expanded="false" class="versioner-trigger navbar-link">
      中文 <i class="fa fa-caret-down"></i>
    </a>

    <ul id="drop1" class="navbar-dropdown dropdown-menu f-dropdown" data-dropdown-content aria-hidden="true" tabindex="-1">
      
      
      
          
          
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/docs/topics/charts/"><code>en</code> &nbsp; English</a></li>
                
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
      
          
          
              

            
              

            
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/es/docs/topics/charts/"><code>es</code> &nbsp; Español</a></li>
                
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
      
          
          
              

            
              

            
              

            
              

            
              

            
              

            
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/ko/docs/topics/charts/"><code>ko</code> &nbsp; 한국어</a></li>
                
              

            
              

            
              

            
              

            
      
          
          
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/zh/docs/topics/charts/" class="active"><code>zh</code> &nbsp; 中文</a></li>
                
              

            
      
      <li class="navbar-item l18n-prompt"><a href="https://github.com/helm/helm-www#internationalization--translation"><small>翻译这个页面</small></a></li>
    </ul>
  </li>
  

        




  <li class="versioner navbar-item has-dropdown is-right is-hoverable">
    
    <a data-dropdown="drop1" aria-controls="drop1" aria-expanded="false" class="versioner-trigger navbar-link">
      v3.13.0 <i class="fa fa-caret-down"></i>
    </a>
    

    <ul id="drop1" class="navbar-dropdown dropdown-menu f-dropdown" data-dropdown-content aria-hidden="true" tabindex="-1">
      
      <li>
        <a href="https://helm.sh/docs" class="navbar-item">
          v3.13.0 <em>stable</em>
        </a>
      </li>
      
      <li>
        <a href="https://v2.helm.sh/docs" class="navbar-item">
          v2.17.0
        </a>
      </li>
      
    </ul>
  </li>

        <li class="">
          <a class="button not-fixed is-outlined" href="/zh/docs/intro/quickstart">从这里开始</a>
        </li>
      </ul>
    </div>

    
    <div class="navbar-end is-hidden-tablet">
      <div id="navbarBurger" class="navbar-burger burger" data-target="navMenuDocumentation">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
</nav>

    



<nav class="navbar navbar-top navbar-top-fixed" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    
    <div class="navbar-brand">
      <a href="/">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 304 351"><title>Helm</title>
<mask id="a" fill="#fff">
<path d="m0 0h313.303155v159.864865h-313.303155z" fill="#fff" fill-rule="evenodd"/>
</mask>
<mask id="b" fill="#fff">
<path d="m0 0h313.303155v159.864865h-313.303155z" fill="#fff" fill-rule="evenodd"/>
</mask>
<g fill="none" fill-rule="evenodd" transform="translate(-11 -51)">
<path d="m11.6785714 189h19.7858357v26.789h23.9037v-26.789h19.7858358v75.25h-19.7858358v-28.695333h-23.9037v28.695333h-19.7858357zm86.1738429 75.25v-75.25h46.8030427v16.354333h-27.017207v12.240667h23.9037v16.655333h-23.9037v13.846h27.017207v16.153667zm68.4971567 0v-75.25h19.785836v55.384h27.117643v19.866zm77.536372-75.25 30.733328 27.892667 30.632893-27.892667h8.938779v75.25h-19.886272v-38.628333l-19.6854 17.959666-19.785835-17.859333v38.528h-19.886272v-75.25z" fill="#0f1689"/>
<g transform="matrix(1 0 0 -1 11.958136 455)">
<g fill="#0f1689" mask="url(#a)">
<path d="m203.460676 95.6875425c6.93631 0 12.559301-14.8092194 12.559301-33.0773172s-5.622991-33.0773172-12.559301-33.0773172c-6.936311 0-12.559301 14.8092194-12.559301 33.0773172s5.62299 33.0773172 12.559301 33.0773172z" transform="matrix(.81915204 .57357644 -.57357644 .81915204 111.870091 -51.706556)"/>
<path d="m30.1423223 95.6875425c6.9363104 0 12.559301-14.8092194 12.559301-33.0773172s-5.6229906-33.0773172-12.559301-33.0773172-12.5593009 14.8092194-12.5593009 33.0773172 5.6229905 33.0773172 12.5593009 33.0773172z" transform="matrix(-.81915204 .57357644 .57357644 .81915204 58.084611 47.704768)"/>
<path d="m116.732815 66.2752676c6.936311 0 12.559301-14.8092193 12.559301-33.0773172 0-18.2680978-5.62299-33.07731713-12.559301-33.07731713-6.93631 0-12.559301 14.80921933-12.559301 33.07731713 0 18.2680979 5.622991 33.0773172 12.559301 33.0773172z" transform="matrix(-1 0 0 1 272.628524 53.670762)"/>
</g>
<path d="m251.467006 173.099849c-20.230076-33.609969-56.889565-56.067908-98.755776-56.067908-40.720798 0-76.5158766 21.245901-97.0586959 53.334588m2.1981107 129.169534c20.8403036 30.232701 55.5559042 50.026591 94.8605852 50.026591 39.376099 0 74.146424-19.865887 94.974049-50.191495" mask="url(#a)" stroke="#0f1689" stroke-width="20"/>
</g>
<g transform="translate(11.958136)">
<g fill="#0f1689" mask="url(#b)">
<path d="m203.460676 95.6875425c6.93631 0 12.559301-14.8092194 12.559301-33.0773172s-5.622991-33.0773172-12.559301-33.0773172c-6.936311 0-12.559301 14.8092194-12.559301 33.0773172s5.62299 33.0773172 12.559301 33.0773172z" transform="matrix(.81915204 .57357644 -.57357644 .81915204 111.870091 -54.166016)"/>
<path d="m30.1423223 95.6875425c6.9363104 0 12.559301-14.8092194 12.559301-33.0773172s-5.6229906-33.0773172-12.559301-33.0773172-12.5593009 14.8092194-12.5593009 33.0773172 5.6229905 33.0773172 12.5593009 33.0773172z" transform="matrix(-.81915204 .57357644 .57357644 .81915204 58.084611 45.245308)"/>
<path d="m116.732815 66.2752676c6.936311 0 12.559301-14.8092193 12.559301-33.0773172 0-18.2680978-5.62299-33.07731713-12.559301-33.07731713-6.93631 0-12.559301 14.80921933-12.559301 33.07731713 0 18.2680979 5.622991 33.0773172 12.559301 33.0773172z" transform="matrix(-1 0 0 1 272.628524 51.211302)"/>
</g>
<path d="m251.467006 170.64039c-20.230076-33.609969-56.889565-56.067908-98.755776-56.067908-40.720798 0-76.5158766 21.2459-97.0586959 53.334587m2.1981107 129.169534c20.8403036 30.232702 55.5559042 50.026591 94.8605852 50.026591 39.376099 0 74.146424-19.865886 94.974049-50.191494" mask="url(#b)" stroke="#0f1689" stroke-width="20"/>
</g>
</g>
</svg>
      </a>
    </div>

    
    <div class="navbar-menu is-centered" id="navMenuDocumentation">
      
        
          <a href="/zh/" class="navbar-item">
            首页
          </a>
        
      
        
          <a href="/zh/docs" class="navbar-item">
            文档
          </a>
        
      
        
          <a href="https://hub.helm.sh/" class
          ="navbar-item external" target="_blank">
            应用中心 <span class="icon"><i class="mdi mdi-open-in-new"></i></span>
          </a>
        
      
        
          <a href="https://helm.sh/blog" class
          ="navbar-item external" target="_blank">
            博客 <span class="icon"><i class="mdi mdi-open-in-new"></i></span>
          </a>
        
      
        
          <a href="https://github.com/helm/community" class
          ="navbar-item external" target="_blank">
            社区 <span class="icon"><i class="mdi mdi-open-in-new"></i></span>
          </a>
        
      
    </div>

    <div class="navbar-end is-hidden-mobile">
      <ul class="is-pulled-right">
        





  <li class="versioner l18ner navbar-item has-dropdown is-right is-hoverable">
    <a data-dropdown="drop1" aria-controls="drop1" aria-expanded="false" class="versioner-trigger navbar-link">
      中文 <i class="fa fa-caret-down"></i>
    </a>

    <ul id="drop1" class="navbar-dropdown dropdown-menu f-dropdown" data-dropdown-content aria-hidden="true" tabindex="-1">
      
      
      
          
          
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/docs/topics/charts/"><code>en</code> &nbsp; English</a></li>
                
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
      
          
          
              

            
              

            
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/es/docs/topics/charts/"><code>es</code> &nbsp; Español</a></li>
                
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
      
          
          
              

            
              

            
              

            
              

            
              

            
              

            
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/ko/docs/topics/charts/"><code>ko</code> &nbsp; 한국어</a></li>
                
              

            
              

            
              

            
              

            
      
          
          
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              

            
              
                
                
                    <li class="navbar-item"><a href="https://zou-zongming.github.io/zh/docs/topics/charts/" class="active"><code>zh</code> &nbsp; 中文</a></li>
                
              

            
      
      <li class="navbar-item l18n-prompt"><a href="https://github.com/helm/helm-www#internationalization--translation"><small>翻译这个页面</small></a></li>
    </ul>
  </li>
  

        




  <li class="versioner navbar-item has-dropdown is-right is-hoverable">
    
    <a data-dropdown="drop1" aria-controls="drop1" aria-expanded="false" class="versioner-trigger navbar-link">
      v3.13.0 <i class="fa fa-caret-down"></i>
    </a>
    

    <ul id="drop1" class="navbar-dropdown dropdown-menu f-dropdown" data-dropdown-content aria-hidden="true" tabindex="-1">
      
      <li>
        <a href="https://helm.sh/docs" class="navbar-item">
          v3.13.0 <em>stable</em>
        </a>
      </li>
      
      <li>
        <a href="https://v2.helm.sh/docs" class="navbar-item">
          v2.17.0
        </a>
      </li>
      
    </ul>
  </li>

        <li>
          <a class="button not-fixed is-outlined" href="/zh/docs/intro/quickstart">从这里开始</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

  </header>

  <div class="columns" id="helm">
    <aside class="column is-narrow is-gapless sidebar-wrapper">
      

<input type="checkbox" class="hamburger-trigger" />
<small class="hamburger">
  <span></span>
  <span></span>
  <span></span>
</small>

<div class="sidebar">
  <div class="is-visible-mobile is-hidden-tablet" id="sidebar-toggle">Browse Docs <span class="icon"><i class="mdi mdi-arrow-down"></i></span></div>

  <div class="sidebar-content-wrapper">
    <div class="search-container">
      <input id="q" placeholder="Search..." autofocus>
      <span class="icon"><i class="mdi mdi-magnify"></i></span>
    </div>

    
    <nav class="sidebar-nav">

      <ul class="current sidebar-main">
        <li class="sidebar-nav-item toctree-l1">
          <a class="reference internal" href="/zh/docs/" state="">
            <span class="ripple">
              文档首页
            </span>
          </a>
        </li>

        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/intro/">
    <span class="ripple">
      介绍
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/intro/quickstart/" title="Switch to 快速入门指南">
        快速入门指南
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/intro/install/" title="Switch to 安装Helm">
        安装Helm
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/intro/using_helm/" title="Switch to 使用Helm">
        使用Helm
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/intro/cheatsheet/" title="Switch to ">
        
      </a>
    </li>
    
  </ul>
  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/howto/">
    <span class="ripple">
      如何使用
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/howto/charts_tips_and_tricks/" title="Switch to chart开发提示和技巧">
        chart开发提示和技巧
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/howto/chart_repository_sync_example/" title="Switch to 同步你的Chart仓库">
        同步你的Chart仓库
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/howto/chart_releaser_action/" title="Switch to Chart发布操作用以自动化GitHub的页面Chart">
        Chart发布操作用以自动化GitHub的页面Chart
      </a>
    </li>
    
  </ul>
  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/topics/">
    <span class="ripple">
      主题
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/charts/" title="Switch to Chart">
        Chart
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/charts_hooks/" title="Switch to Chart Hook">
        Chart Hook
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/chart_tests/" title="Switch to Chart Test">
        Chart Test
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/library_charts/" title="Switch to 库类型Chart">
        库类型Chart
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/provenance/" title="Switch to Helm来源和完整性">
        Helm来源和完整性
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/chart_repository/" title="Switch to Chart仓库指南">
        Chart仓库指南
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/registries/" title="Switch to 使用基于OCI的注册中心">
        使用基于OCI的注册中心
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/architecture/" title="Switch to Helm 架构">
        Helm 架构
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/advanced/" title="Switch to Helm高级技术">
        Helm高级技术
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/kubernetes_distros/" title="Switch to Kubernetes分发指南">
        Kubernetes分发指南
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/rbac/" title="Switch to 基于角色的访问控制">
        基于角色的访问控制
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/plugins/" title="Switch to Helm插件指南">
        Helm插件指南
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/v2_v3_migration/" title="Switch to Helm v2 迁移到 v3">
        Helm v2 迁移到 v3
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/version_skew/" title="Switch to Helm版本支持策略">
        Helm版本支持策略
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/permissions_sql_storage_backend/" title="Switch to SQL存储后端的权限管理">
        SQL存储后端的权限管理
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/release_policy/" title="Switch to 发布计划策略">
        发布计划策略
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/topics/kubernetes_apis/" title="Switch to 弃用的 Kubernetes API">
        弃用的 Kubernetes API
      </a>
    </li>
    
  </ul>
  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/chart_best_practices/">
    <span class="ripple">
      最佳实践
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/conventions/" title="Switch to 一般惯例">
        一般惯例
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/values/" title="Switch to values">
        values
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/templates/" title="Switch to 模板">
        模板
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/dependencies/" title="Switch to 依赖">
        依赖
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/labels/" title="Switch to 标签和注释">
        标签和注释
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/pods/" title="Switch to pod和pod模板">
        pod和pod模板
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/custom_resource_definitions/" title="Switch to 自定义资源">
        自定义资源
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_best_practices/rbac/" title="Switch to 基于角色的访问控制">
        基于角色的访问控制
      </a>
    </li>
    
  </ul>
  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/chart_template_guide/">
    <span class="ripple">
      Chart 模板指南
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/getting_started/" title="Switch to 从这里开始吧">
        从这里开始吧
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/builtin_objects/" title="Switch to 内置对象">
        内置对象
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/values_files/" title="Switch to Values 文件">
        Values 文件
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/functions_and_pipelines/" title="Switch to 模板函数和流水线">
        模板函数和流水线
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/function_list/" title="Switch to 模板函数列表">
        模板函数列表
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/control_structures/" title="Switch to 流控制">
        流控制
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/variables/" title="Switch to 变量">
        变量
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/named_templates/" title="Switch to 命名模板">
        命名模板
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/accessing_files/" title="Switch to 在模板内部访问文件">
        在模板内部访问文件
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/notes_files/" title="Switch to 创建一个NOTES.txt文件">
        创建一个NOTES.txt文件
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/subcharts_and_globals/" title="Switch to 子chart和全局值">
        子chart和全局值
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/helm_ignore_file/" title="Switch to .helmignore 文件">
        .helmignore 文件
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/debugging/" title="Switch to 调试模板">
        调试模板
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/wrapping_up/" title="Switch to 下一步">
        下一步
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/yaml_techniques/" title="Switch to 附录： YAML技术">
        附录： YAML技术
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/chart_template_guide/data_types/" title="Switch to 附录：Go 数据类型和模板">
        附录：Go 数据类型和模板
      </a>
    </li>
    
  </ul>
  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/helm/">
    <span class="ripple">
      Helm 命令行
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_delete/" title="Switch to ">
        
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_init/" title="Switch to ">
        
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_inspect/" title="Switch to ">
        
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm/" title="Switch to Helm">
        Helm
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_install/" title="Switch to Helm 安装">
        Helm 安装
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_version/" title="Switch to Helm 版本">
        Helm 版本
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_package/" title="Switch to Helm 包">
        Helm 包
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_env/" title="Switch to Helm 变量">
        Helm 变量
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_completion/" title="Switch to Helm 补全">
        Helm 补全
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_repo/" title="Switch to Helm 仓库">
        Helm 仓库
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_repo_update/" title="Switch to Helm 仓库更新">
        Helm 仓库更新
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_repo_list/" title="Switch to Helm 仓库列表">
        Helm 仓库列表
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_repo_index/" title="Switch to Helm 仓库索引">
        Helm 仓库索引
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_test/" title="Switch to Helm 测试">
        Helm 测试
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_plugin/" title="Switch to Helm 插件">
        Helm 插件
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_plugin_install/" title="Switch to Helm 插件安装">
        Helm 插件安装
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_plugin_list/" title="Switch to Helm 插件列表">
        Helm 插件列表
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_plugin_update/" title="Switch to Helm 插件升级">
        Helm 插件升级
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_plugin_uninstall/" title="Switch to Helm 插件卸载">
        Helm 插件卸载
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_rollback/" title="Switch to Helm 回滚">
        Helm 回滚
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_get_hooks/" title="Switch to Helm 获取钩子">
        Helm 获取钩子
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_get/" title="Switch to Helm 获取扩展">
        Helm 获取扩展
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_get_manifest/" title="Switch to Helm 获取清单">
        Helm 获取清单
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_get_all/" title="Switch to Helm 获取所有">
        Helm 获取所有
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_get_notes/" title="Switch to Helm 获取注释">
        Helm 获取注释
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_pull/" title="Switch to Helm 拉取">
        Helm 拉取
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_history/" title="Switch to Helm 历史">
        Helm 历史
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_list/" title="Switch to Helm 列表">
        Helm 列表
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_template/" title="Switch to Helm 模板">
        Helm 模板
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_repo_remove/" title="Switch to Helm 删除仓库">
        Helm 删除仓库
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_upgrade/" title="Switch to Helm 升级">
        Helm 升级
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_search/" title="Switch to Helm 搜索">
        Helm 搜索
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_search_hub/" title="Switch to Helm 搜索hub">
        Helm 搜索hub
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_search_repo/" title="Switch to Helm 搜索仓库">
        Helm 搜索仓库
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_repo_add/" title="Switch to Helm 添加仓库">
        Helm 添加仓库
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_push/" title="Switch to Helm 推送">
        Helm 推送
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_uninstall/" title="Switch to Helm 卸载">
        Helm 卸载
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_lint/" title="Switch to Helm 验证">
        Helm 验证
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_verify/" title="Switch to Helm 验证">
        Helm 验证
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_dependency/" title="Switch to Helm 依赖">
        Helm 依赖
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_dependency_list/" title="Switch to Helm 依赖列表">
        Helm 依赖列表
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_show/" title="Switch to Helm 展示">
        Helm 展示
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_show_chart/" title="Switch to Helm 展示chart">
        Helm 展示chart
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_show_crds/" title="Switch to Helm 展示Crd">
        Helm 展示Crd
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_show_readme/" title="Switch to Helm 展示readme">
        Helm 展示readme
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_show_values/" title="Switch to Helm 展示value">
        Helm 展示value
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_show_all/" title="Switch to Helm 展示所有">
        Helm 展示所有
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_registry/" title="Switch to Helm 注册表">
        Helm 注册表
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_registry_logout/" title="Switch to Helm 注册表登出">
        Helm 注册表登出
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_registry_login/" title="Switch to Helm 注册表登录">
        Helm 注册表登录
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_status/" title="Switch to Helm 状态">
        Helm 状态
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_completion_bash/" title="Switch to Helm补全 - bash">
        Helm补全 - bash
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_completion_fish/" title="Switch to Helm补全 - fish">
        Helm补全 - fish
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_completion_powershell/" title="Switch to Helm补全 - Powershell">
        Helm补全 - Powershell
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_completion_zsh/" title="Switch to Helm补全 - zsh">
        Helm补全 - zsh
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_create/" title="Switch to Helm创建">
        Helm创建
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_get_values/" title="Switch to Helm获取Values">
        Helm获取Values
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_dependency_build/" title="Switch to Helm依赖构建">
        Helm依赖构建
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/helm/helm_dependency_update/" title="Switch to Helm依赖升级">
        Helm依赖升级
      </a>
    </li>
    
  </ul>
  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/community/">
    <span class="ripple">
      社区
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/community/developers/" title="Switch to 开发者指南">
        开发者指南
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/community/release_checklist/" title="Switch to 版本 Checklist">
        版本 Checklist
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/community/related/" title="Switch to 相关项目及文档">
        相关项目及文档
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/community/history/" title="Switch to 项目历史">
        项目历史
      </a>
    </li>
    
    <li class="toctree-12">
      <a href="/zh/docs/community/localization/" title="Switch to 本地化Helm文档">
        本地化Helm文档
      </a>
    </li>
    
  </ul>
  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/faq/">
    <span class="ripple">
      常见问答(FAQ)
    </span>
  </a>

  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/glossary/">
    <span class="ripple">
      术语表
    </span>
  </a>

  
</li>

            
          
            
              <li class="sidebar-nav-item toctree-l1">
  <a class="reference internal" href="/zh/docs/example/">
    <span class="ripple">
      集成开发
    </span>
  </a>

  
  <ul class="current">
    
    <li class="toctree-12">
      <a href="/zh/docs/example/golang/" title="Switch to ">
        
      </a>
    </li>
    
  </ul>
  
</li>

            
          
        

      </ul>
    </nav>

    <aside class="sidebar-buttons is-hidden-mobile">
      <div class="button-wrap">
        <a href="https://github.com/helm/helm-www#contributing" class="button is-outline is-fullwidth">Contribute to Docs</a>
      </div>
    </aside>
  </div>
</div>
    </aside>
    
    <section class="column content-docs">
      <article class="content-wrapper">
        <h1>Chart</h1>
        
        <p>Helm使用的包格式称为 <em>chart</em>。 chart就是一个描述Kubernetes相关资源的文件集合。单个chart可以用来部署一些简单的，
类似于memcache pod，或者某些复杂的HTTP服务器以及web全栈应用、数据库、缓存等等。</p>
<p>Chart是作为特定目录布局的文件被创建的。它们可以打包到要部署的版本存档中。</p>
<p>如果你想下载和查看一个发布的chart，但不安装它，你可以用这个命令： <code>helm pull chartrepo/chartname</code>。</p>
<p>该文档解释说明了chart格式，并提供了用Helm构建chart的基本指导。</p>
<h2 id="chart-文件结构">Chart 文件结构</h2>
<p>chart是一个组织在文件目录中的集合。目录名称就是chart名称（没有版本信息）。因而描述WordPress的chart可以存储在<code>wordpress/</code>目录中。</p>
<p>在这个目录中，Helm 期望可以匹配以下结构：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>wordpress/
</span></span><span style="display:flex;"><span>  Chart.yaml          # 包含了chart信息的YAML文件
</span></span><span style="display:flex;"><span>  LICENSE             # 可选: 包含chart许可证的纯文本文件
</span></span><span style="display:flex;"><span>  README.md           # 可选: 可读的README文件
</span></span><span style="display:flex;"><span>  values.yaml         # chart 默认的配置值
</span></span><span style="display:flex;"><span>  values.schema.json  # 可选: 一个使用JSON结构的values.yaml文件
</span></span><span style="display:flex;"><span>  charts/             # 包含chart依赖的其他chart
</span></span><span style="display:flex;"><span>  crds/               # 自定义资源的定义
</span></span><span style="display:flex;"><span>  templates/          # 模板目录， 当和values 结合时，可生成有效的Kubernetes manifest文件
</span></span><span style="display:flex;"><span>  templates/NOTES.txt # 可选: 包含简要使用说明的纯文本文件
</span></span></code></pre></div><p>Helm保留使用 <code>charts/</code>，<code>crds/</code>， <code>templates/</code>目录，以及列举出的文件名。其他文件保持原样。</p>
<h2 id="chartyaml-文件">Chart.yaml 文件</h2>
<p><code>Chart.yaml</code>文件是chart必需的。包含了以下字段：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>chart API 版本 （必需）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>chart名称 （必需）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span>语义化2 版本（必需）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">kubeVersion</span>:<span style="color:#bbb"> </span>兼容Kubernetes版本的语义化版本（可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">description</span>:<span style="color:#bbb"> </span>一句话对这个项目的描述（可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">type</span>:<span style="color:#bbb"> </span>chart类型 （可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">keywords</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- 关于项目的一组关键字（可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">home</span>:<span style="color:#bbb"> </span>项目home页面的URL （可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">sources</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- 项目源码的URL列表（可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">dependencies</span>:<span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># chart 必要条件列表 （可选）</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>chart名称 (nginx)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span>chart版本 (&#34;1.2.3&#34;)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>（可选）仓库URL (&#34;https://example.com/charts&#34;) 或别名 (&#34;@repo-name&#34;)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">condition</span>:<span style="color:#bbb"> </span>（可选） 解析为布尔值的yaml路径，用于启用/禁用chart (e.g. subchart1.enabled )<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">tags</span>:<span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># （可选）</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- 用于一次启用/禁用 一组chart的tag<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">import-values</span>:<span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># （可选）</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- ImportValue 保存源值到导入父键的映射。每项可以是字符串或者一对子/父列表项<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">alias</span>:<span style="color:#bbb"> </span>（可选） chart中使用的别名。当你要多次添加相同的chart时会很有用<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">maintainers</span>:<span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># （可选）</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>维护者名字 （每个维护者都需要）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">email</span>:<span style="color:#bbb"> </span>维护者邮箱 （每个维护者可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">url</span>:<span style="color:#bbb"> </span>维护者URL （每个维护者可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">icon</span>:<span style="color:#bbb"> </span>用做icon的SVG或PNG图片URL （可选）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">appVersion</span>:<span style="color:#bbb"> </span>包含的应用版本（可选）。不需要是语义化，建议使用引号<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">deprecated</span>:<span style="color:#bbb"> </span>不被推荐的chart （可选，布尔值）<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">annotations</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">example</span>:<span style="color:#bbb"> </span>按名称输入的批注列表 （可选）.<span style="color:#bbb">
</span></span></span></code></pre></div><p>从
<a href="https://github.com/helm/helm/releases/tag/v3.3.2" target="_blank">v3.3.2</a>，不再允许额外的字段。推荐的方法是在
<code>annotations</code> 中添加自定义元数据。</p>
<h3 id="chart和版本控制">Chart和版本控制</h3>
<p>每个chart都必须有个版本号。版本必须遵循 
<a href="https://semver.org/spec/v2.0.0.html" target="_blank">语义化版本 2</a> 标准。
不像经典Helm， Helm v2以及后续版本会使用版本号作为发布标记。仓库中的包通过名称加版本号标识。</p>
<p>比如 <code>nginx</code> chart的版本字段<code>version: 1.2.3</code>按照名称被设置为：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>nginx-1.2.3.tgz
</span></span></code></pre></div><p>更多复杂的语义化版本2 都是支持的，比如 <code>version: 1.2.3-alpha.1+ef365</code>。 但系统明确禁止非语义化版本名称。</p>
<p><strong>注意：</strong> 鉴于经典Helm和部署管理器在使用chart时都非常倾向于GitHub，Helm v2 和后续版本不再依赖或需要GitHub甚至是Git。
因此，它完全不使用Git SHA进行版本控制。</p>
<p><code>Chart.yaml</code>文件中的<code>version</code>字段被很多Helm工具使用，包括CLI。当生成一个包时，
<code>helm package</code>命令可以用<code>Chart.yaml</code>文件中找到的版本号作为包名中的token。
系统假设chart包名中的版本号可以与<code>Chart.yaml</code>文件中的版本号匹配。如果不满足这一假设会导致错误。</p>
<h3 id="apiversion-字段"><code>apiVersion</code> 字段</h3>
<p>对于至少需要Helm 3的chart，<code>apiVersion</code> 字段应该是 <code>v2</code>。Chart支持之前<code>apiVersion</code> 设置为 <code>v1</code> 的Helm 版本，
并且在Helm 3中仍然可安装。</p>
<p><code>v1</code> 到 <code>v2</code>的改变：</p>
<ul>
<li><code>dependencies</code>字段定义了chart的依赖，针对于<code>v1</code> 版本的chart被放置在分隔开的<code>requirements.yaml</code> 文件中
（查看 
<a href="#chart-dependency">Chart 依赖</a>).</li>
<li><code>type</code>字段, 用于识别应用和库类型的chart（查看 
<a href="#chart-types">Chart 类型</a>).</li>
</ul>
<h3 id="appversion-字段"><code>appVersion</code> 字段</h3>
<p>注意这个<code>appVersion</code>字段与<code>version</code>字段并不相关。这是指定应用版本的一种方式。比如，这个<code>drupal</code> chart可能有一个
<code>appVersion: &quot;8.2.1&quot;</code>，表示包含在chart（默认）的Drupal的版本是<code>8.2.1</code>。此字段仅供参考，对chart版本计算没有影响。
强烈建议使用引号将版本括起来。它强制YAML解析器将版本号视为字符串。不加引号在某些场景会出现解析问题。
比如，YAML将<code>1.0</code>解释为浮点值，且git提交的SHA类似<code>1234e10</code>是科学计数法。</p>
<p>从Helm v3.5.0开始，<code>helm create</code>会将默认的<code>appVersion</code>用引号括起来。</p>
<h3 id="kubeversion-字段"><code>kubeVersion</code> 字段</h3>
<p>可选的 <code>kubeVersion</code> 字段可以在支持的Kubernetes版本上定义语义化版本约束，Helm 在安装chart时会验证这个版本约束，
并在集群运行不支持的Kubernetes版本时显示失败。</p>
<p>版本约束可以包括空格分隔和比较运算符，比如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>&gt;= 1.13.0 &lt; 1.15.0<span style="color:#bbb">
</span></span></span></code></pre></div><p>或者它们可以用或操作符 <code>||</code> 连接，比如：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>&gt;= 1.13.0 &lt; 1.14.0 || &gt;= 1.14.1 &lt; 1.15.0<span style="color:#bbb">
</span></span></span></code></pre></div><p>这个例子中排除了 <code>1.14.0</code> 版本，如果确定某些版本中的错误导致chart无法正常运行，这一点就很有意义。</p>
<p>除了版本约束外，使用运算符 <code>=</code> <code>!=</code> <code>&gt;</code> <code>&lt;</code> <code>&gt;=</code> <code>&lt;=</code> 支持一下速记符号：</p>
<ul>
<li>闭合间隔的连字符范围， <code>1.1 - 2.3.4</code> 等价于 <code>&gt;= 1.1 &lt;= 2.3.4</code></li>
<li>通配符 <code>x</code>， <code>X</code> 和 <code>*</code>， <code>1.2.x</code> 等价于 <code>&gt;= 1.2.0 &lt; 1.3.0</code></li>
<li>波浪符号~范围 （允许改变补丁版本）， <code>~1.2.3</code> 等价于 <code>&gt;= 1.2.3 &lt; 1.3.0</code></li>
<li>插入符号^范围 （允许改变次版本）， <code>^1.2.3</code> 等价于 <code>&gt;= 1.2.3 &lt; 2.0.0</code></li>
</ul>
<p>支持的语义化版本约束的细节说明请查看 
<a href="https://github.com/Masterminds/semver" target="_blank">Masterminds/semver</a></p>
<h3 id="已弃用的chart">已弃用的Chart</h3>
<p>在Chart仓库管理chart时，有时需要废弃一个chart。 <code>Chart.yaml</code> 中可选的<code>deprecated</code>字段可以用来标记已弃用的chart。
如果<strong>latest</strong>版本被标记为已弃用，则所有的chart都会被认为是已弃用的。以后可以通过发布未标记为已弃用的新版本来重新使用chart名称。
弃用chart的工作流是：</p>
<ol>
<li>升级chart的 <code>Chart.yaml</code>  文件，将这个chart标记为已弃用， 并更改版本</li>
<li>在chart仓库中发布新版的chart</li>
<li>从源仓库中移除这个chart （比如用 git）</li>
</ol>
<h3 id="chart-types">Chart Types</h3>
<p><code>type</code>字段定义了chart的类型。有两种类型： <code>application</code> 和 <code>library</code>。 应用是默认类型，是可以完全操作的标准chart。

<a href="http://helm.sh/zh/docs/topics/library_charts" target="_blank">库类型 chart</a> 提供针对chart构建的实用程序和功能。
库类型chart与应用类型chart不同，因为它不能安装，通常不包含任何资源对象。</p>
<p><strong>注意：</strong> 应用类型chart 可以作为库类型chart使用。可以通过将类型设置为 <code>library</code>来实现。
然后这个库就被渲染成了一个库类型chart，所有的实用程序和功能都可以使用。所有的资源对象不会被渲染。</p>
<h2 id="chart-许可证自述和注释">Chart 许可证，自述和注释</h2>
<p>Chart也可以包含描述安装，配置和使用文件，以及chart许可证。</p>
<p>许可证（LICENSE）是一个包含了chart 
<a href="https://en.wikipedia.org/wiki/Software_license" target="_blank">license</a>的纯文本文件。
chart可以包含一个许可证，因为在模板里不只是配置，还可能有编码逻辑。如果需要，还可以为chart安装的应用程序提供单独的许可证。</p>
<p>chart的自述文件README文件应该使用Markdown格式(README.md)，一般应包含：</p>
<ul>
<li>chart提供的应用或服务的描述</li>
<li>运行chart的先决条件或要求</li>
<li><code>values.yaml</code>的可选项和默认值的描述</li>
<li>与chart的安装或配置相关的其他任何信息</li>
</ul>
<p><code>README.md</code> 文件会包含hub和用户接口显示的chart的详细信息。</p>
<p>chart也会包含一个简短的纯文本 <code>templates/NOTES.txt</code> 文件，这会在安装后及查看版本状态时打印出来。
这个文件会作为一个 
<a href="#templates-and-values">模板</a>来评估，并用来显示使用说明，后续步骤，或者其他chart版本的相关信息。
比如，可以提供连接数据库的说明，web UI的访问。由于此文件是在运行<code>helm install</code>或<code>helm status</code>时打印到STDOUT的，
因此建议保持内容简短，并指向自述文件以获取更多详细信息。</p>
<h2 id="chart-dependency">Chart dependency</h2>
<p>Helm 中，chart可能会依赖其他任意个chart。 这些依赖可以使用<code>Chart.yaml</code>文件中的<code>dependencies</code>
字段动态链接，或者被带入到<code>charts/</code> 目录并手动配置。</p>
<h3 id="使用-dependencies-字段管理依赖">使用 <code>dependencies</code> 字段管理依赖</h3>
<p>当前chart依赖的其他chart会在<code>dependencies</code>字段定义为一个列表。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">dependencies</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>apache<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">1.2.3</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>https://example.com/charts<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>mysql<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">3.2.1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>https://another.example.com/charts<span style="color:#bbb">
</span></span></span></code></pre></div><ul>
<li><code>name</code>字段是你需要的chart的名称</li>
<li><code>version</code>字段是你需要的chart的版本</li>
<li><code>repository</code>字段是chart仓库的完整URL。注意你必须使用<code>helm repo add</code>在本地添加仓库</li>
<li>你可以使用仓库的名称代替URL</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#009;font-weight:bold">$</span> helm repo add fantastic-charts https://charts.helm.sh/incubator
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">dependencies</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>awesomeness<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">1.0.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;@fantastic-charts&#34;</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>一旦你定义好了依赖，运行 <code>helm dependency update</code> 就会使用你的依赖文件下载所有你指定的chart到你的<code>charts/</code>目录。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#009;font-weight:bold">$</span> helm dep up foochart
</span></span><span style="display:flex;"><span><span style="color:#aaa">Hang tight while we grab the latest from your chart repositories...
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">...Successfully got an update from the &#34;local&#34; chart repository
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">...Successfully got an update from the &#34;stable&#34; chart repository
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">...Successfully got an update from the &#34;example&#34; chart repository
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">...Successfully got an update from the &#34;another&#34; chart repository
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">Update Complete. Happy Helming!
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">Saving 2 charts
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">Downloading apache from repo https://example.com/charts
</span></span></span><span style="display:flex;"><span><span style="color:#aaa">Downloading mysql from repo https://another.example.com/charts
</span></span></span></code></pre></div><p>当 <code>helm dependency update</code> 拉取chart时，会在<code>charts/</code>目录中形成一个chart包。因此对于上面的示例，会在chart目录中期望看到以下文件：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>charts/
</span></span><span style="display:flex;"><span>  apache-1.2.3.tgz
</span></span><span style="display:flex;"><span>  mysql-3.2.1.tgz
</span></span></code></pre></div><h4 id="依赖的别名字段">依赖的别名字段</h4>
<p>除了上面的其他字段之外，每个需求项可以包含一个可选的字段 <code>alias</code>。
为依赖chart添加一个别名，会使用别名作为新依赖chart的名称。
需要使用其他名称访问chart时可以使用<code>alias</code>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parentchart/Chart.yaml</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">dependencies</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>subchart<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>http://localhost:10191<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">0.1.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">alias</span>:<span style="color:#bbb"> </span>new-subchart-1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>subchart<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>http://localhost:10191<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">0.1.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">alias</span>:<span style="color:#bbb"> </span>new-subchart-2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>subchart<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>http://localhost:10191<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">0.1.0</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>上述例子中，我们会获得<code>parentchart</code>所有的3个依赖项：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>subchart
</span></span><span style="display:flex;"><span>new-subchart-1
</span></span><span style="display:flex;"><span>new-subchart-2
</span></span></code></pre></div><p>手动完成的方式是将同一个chart用不同的名称复制/粘贴多次到<code>charts/</code>目录中。</p>
<h4 id="依赖中的tag和条件字段">依赖中的tag和条件字段</h4>
<p>除了上面的其他字段外，每个需求项可以包含可选字段 <code>tags</code> 和 <code>condition</code>。</p>
<p>所有的chart会默认加载。如果存在 <code>tags</code> 或者 <code>condition</code> 字段，它们将被评估并用于控制它们应用的chart的加载。</p>
<p>Condition - 条件字段field 包含一个或多个YAML路径（用逗号分隔）。
如果这个路径在上层values中已存在并解析为布尔值，chart会基于布尔值启用或禁用chart。
只会使用列表中找到的第一个有效路径，如果路径为未找到则条件无效。</p>
<p>Tags - tag字段是与chart关联的YAML格式的标签列表。在顶层value中，通过指定tag和布尔值，可以启用或禁用所有的带tag的chart。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parentchart/Chart.yaml</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">dependencies</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>subchart1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>http://localhost:10191<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">0.1.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">condition</span>:<span style="color:#bbb"> </span>subchart1.enabled,global.subchart1.enabled<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">tags</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- front-end<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- subchart1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>subchart2<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>http://localhost:10191<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">0.1.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">condition</span>:<span style="color:#bbb"> </span>subchart2.enabled,global.subchart2.enabled<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">tags</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- back-end<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- subchart2<span style="color:#bbb">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parentchart/values.yaml</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">subchart1</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">enabled</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">tags</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">front-end</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">false</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">back-end</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>在上面的例子中，所有带 <code>front-end</code>tag的chart都会被禁用，但只要上层的value中
<code>subchart1.enabled</code> 路径被设置为 'true'，该条件会覆盖 <code>front-end</code>标签且 <code>subchart1</code> 会被启用。</p>
<p>一旦 <code>subchart2</code>使用了<code>back-end</code>标签并被设置为了 <code>true</code>，<code>subchart2</code>就会被启用。
也要注意尽管<code>subchart2</code> 指定了一个条件字段， 但是上层value没有相应的路径和value，因此这个条件不会生效。</p>
<h5 id="使用带有标签和条件的cli">使用带有标签和条件的CLI</h5>
<p><code>--set</code> 参数一如既往可以用来设置标签和条件值。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#aaa">helm install --set tags.front-end=true --set subchart2.enabled=false
</span></span></span></code></pre></div><h5 id="标签和条件的解析">标签和条件的解析</h5>
<ul>
<li><strong>条件 （当设置在value中时）总是会覆盖标签</strong> 第一个chart条件路径存在时会忽略后面的路径。</li>
<li>标签被定义为 '如果任意的chart标签是true，chart就可以启用'。</li>
<li>标签和条件值必须被设置在顶层value中。</li>
<li>value中的<code>tags:</code>键必须是顶层键。 全局和嵌套的<code>tags:</code>表现在不支持了。</li>
</ul>
<h4 id="通过依赖导入子value">通过依赖导入子Value</h4>
<p>在某些情况下，允许子chart的值作为公共默认传递到父chart中是值得的。使用
<code>exports</code>格式的额外好处是它可是将来的工具可以自检用户可设置的值。</p>
<p>被导入的包含值的key可以在父chart的 <code>dependencies</code> 中的 <code>import-values</code> 字段以YAML列表形式指定。
列表中的每一项是从子chart中<code>exports</code>字段导入的key。</p>
<p>导入<code>exports</code> key中未包含的值，使用
<a href="#using-the-child-parent-format">子-父</a>格式。两种格式的示例如下所述。</p>
<h5 id="使用导出格式">使用导出格式</h5>
<p>如果子chart的<code>values.yaml</code>文件中在根节点包含了<code>exports</code>字段，它的内容可以通过指定的可以被直接导入到父chart的value中，
如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parent&#39;s Chart.yaml file</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">dependencies</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>subchart<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>http://localhost:10191<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">0.1.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">import-values</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- data<span style="color:#bbb">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># child&#39;s values.yaml file</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">exports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">data</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">myint</span>:<span style="color:#bbb"> </span><span style="color:#f60">99</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>只要我们再导入列表中指定了键<code>data</code>，Helm就会在子chart的<code>exports</code>字段查找<code>data</code>键并导入它的内容。</p>
<p>最终的父级value会包含我们的导出字段：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parent&#39;s values</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">myint</span>:<span style="color:#bbb"> </span><span style="color:#f60">99</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>注意父级键 <code>data</code> 没有包含在父级最终的value中，如果想指定这个父级键，要使用'子-父' 格式。</p>
<h5 id="using-the-child-parent-format">Using the child-parent format</h5>
<p>要访问子chart中未包含的 <code>exports</code> 键的值，你需要指定要导入的值的源键(<code>child</code>)和父chart(<code>parent</code>)中值的目标路径。</p>
<p>下面示例中的<code>import-values</code> 指示Helm去拿到能再<code>child:</code>路径中找到的任何值，并拷贝到<code>parent:</code>的指定路径。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parent&#39;s Chart.yaml file</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">dependencies</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>subchart1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">repository</span>:<span style="color:#bbb"> </span>http://localhost:10191<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#f60">0.1.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">import-values</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- <span style="color:#309;font-weight:bold">child</span>:<span style="color:#bbb"> </span>default.data<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#309;font-weight:bold">parent</span>:<span style="color:#bbb"> </span>myimports<span style="color:#bbb">
</span></span></span></code></pre></div><p>上面的例子中，在subchart1里面找到的<code>default.data</code>的值会被导入到父chart的<code>myimports</code>键中，细节如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parent&#39;s values.yaml file</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">myimports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">myint</span>:<span style="color:#bbb"> </span><span style="color:#f60">0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">mybool</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">false</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">mystring</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;helm rocks!&#34;</span><span style="color:#bbb">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># subchart1&#39;s values.yaml file</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">default</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">data</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">myint</span>:<span style="color:#bbb"> </span><span style="color:#f60">999</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">mybool</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>父chart的结果值将会是这样：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># parent&#39;s final values</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">myimports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">myint</span>:<span style="color:#bbb"> </span><span style="color:#f60">999</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">mybool</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">mystring</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;helm rocks!&#34;</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>父chart中的最终值包含了从 subchart1中导入的<code>myint</code>和<code>mybool</code>字段。</p>
<h3 id="通过charts目录手动管理依赖">通过<code>charts/</code>目录手动管理依赖</h3>
<p>如果对依赖进行更多控制，通过将有依赖关系的chart复制到<code>charts/</code>目录中来显式表达这些依赖关系。</p>
<p>依赖应该是一个解压的chart目录。但是名字不能以<code>_</code>或<code>.</code>开头，否则会被chart加载器忽略。</p>
<p>比如，如果WordPress chart依赖于Apache chart，那么（正确版本的）Apache chart需要放在WordPress chart 的<code>charts/</code>目录中：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">wordpress</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>Chart.yaml<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#09f;font-style:italic"># ...</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>charts/<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>apache/<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>Chart.yaml<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#09f;font-style:italic"># ...</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>mysql/<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>Chart.yaml<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#09f;font-style:italic"># ...</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>上面的例子展示了WordPress chart 如何通过将这些chart包含在 <code>charts/</code> 目录中来表达它对Apache 和 MySQL的依赖。</p>
<p><strong>提示：</strong> <em>要将依赖放入<code>charts/</code>目录，使用 <code>helm pull</code> 命令</em></p>
<h3 id="使用依赖的操作部分">使用依赖的操作部分</h3>
<p>上面的部分说明如何指定chart的依赖，但是对使用 <code>helm install</code> 和 <code>helm upgrade</code> 安装chart有什么影响？</p>
<p>假设有个chart &quot;A&quot; 创建了下面的Kubernetes对象：</p>
<ul>
<li>namespace &quot;A-Namespace&quot;</li>
<li>statefulset &quot;A-StatefulSet&quot;</li>
<li>service &quot;A-Service&quot;</li>
</ul>
<p>另外，A是依赖于chart B创建的对象：</p>
<ul>
<li>namespace &quot;B-Namespace&quot;</li>
<li>replicaset &quot;B-ReplicaSet&quot;</li>
<li>service &quot;B-Service&quot;</li>
</ul>
<p>安装/升级chart A后，会创建/修改一个单独的Helm版本。这个版本会按顺序创建/升级以下所有的Kubernetes对象：</p>
<ul>
<li>A-Namespace</li>
<li>B-Namespace</li>
<li>A-Service</li>
<li>B-Service</li>
<li>B-ReplicaSet</li>
<li>A-StatefulSet</li>
</ul>
<p>这是因为当Helm安装/升级chart时，chart中所有的Kubernetes对象以及依赖会</p>
<ul>
<li>聚合成一个单一的集合；然后</li>
<li>按照类型和名称排序；然后</li>
<li>按这个顺序创建/升级。</li>
</ul>
<p>至此会为chart及其依赖创建一个包含所有对象的release版本。</p>
<p>Kubernetes类型的安装顺序会按照kind_sorter.go(查看 
<a href="https://github.com/helm/helm/blob/484d43913f97292648c867b56768775a55e4bba6/pkg/releaseutil/kind_sorter.go" target="_blank">Helm源文件</a>)中给出的枚举顺序进行。</p>
<h2 id="templates-and-values">Templates and Values</h2>
<p>Helm Chart 模板是按照
<a href="https://golang.org/pkg/text/template/" target="_blank">Go模板语言</a>书写，
增加了50个左右的附加模板函数
<a href="https://github.com/Masterminds/sprig" target="_blank">来自 Sprig库</a>
和一些其他
<a href="https://helm.sh/zh/docs/howto/charts_tips_and_tricks" target="_blank">指定的函数</a>。</p>
<p>所有模板文件存储在chart的 <code>templates/</code> 文件夹。
当Helm渲染chart时，它会通过模板引擎遍历目录中的每个文件。</p>
<p>模板的Value通过两种方式提供：</p>
<ul>
<li>Chart开发者可以在chart中提供一个命名为 <code>values.yaml</code> 的文件。这个文件包含了默认值。</li>
<li>Chart用户可以提供一个包含了value的YAML文件。可以在命令行使用 <code>helm install</code>命令时提供。</li>
</ul>
<p>当用户提供自定义value时，这些value会覆盖chart的<code>values.yaml</code>文件中value。</p>
<h3 id="模板文件">模板文件</h3>
<p>模板文件遵守书写Go模板的标准惯例（查看
<a href="https://golang.org/pkg/text/template/" target="_blank">文本/模板 Go 包文档</a>了解更多）。
模板文件的例子看起来像这样：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>ReplicationController<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>deis<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">app.kubernetes.io/managed-by</span>:<span style="color:#bbb"> </span>deis<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">replicas</span>:<span style="color:#bbb"> </span><span style="color:#f60">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">selector</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">template</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#309;font-weight:bold">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">serviceAccount</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">image</span>:<span style="color:#bbb"> </span>{{<span style="color:#bbb"> </span>.Values.imageRegistry }}/postgres:{{ .Values.dockerTag }}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">imagePullPolicy</span>:<span style="color:#bbb"> </span>{{<span style="color:#bbb"> </span>.Values.pullPolicy }}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">ports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- <span style="color:#309;font-weight:bold">containerPort</span>:<span style="color:#bbb"> </span><span style="color:#f60">5432</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>DATABASE_STORAGE<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">              </span><span style="color:#309;font-weight:bold">value</span>:<span style="color:#bbb"> </span>{{<span style="color:#bbb"> </span>default &#34;minio&#34; .Values.storage }}<span style="color:#bbb">
</span></span></span></code></pre></div><p>上面的例子，松散地基于
<a href="https://github.com/deis/charts" target="_blank">https://github.com/deis/charts</a>，
是一个Kubernetes副本控制器的模板。可以使用下面四种模板值（一般被定义在<code>values.yaml</code>文件）：</p>
<ul>
<li><code>imageRegistry</code>: Docker镜像的源注册表</li>
<li><code>dockerTag</code>: Docker镜像的tag</li>
<li><code>pullPolicy</code>: Kubernetes的拉取策略</li>
<li><code>storage</code>: 后台存储，默认设置为<code>&quot;minio&quot;</code></li>
</ul>
<p>所有的值都是模板作者定义的。Helm不需要或指定参数。</p>
<p>要了解更多chart的工作，请查阅CNCF的 
<a href="https://artifacthub.io/packages/search?kind=0" target="_blank">Artifact Hub</a>。</p>
<h3 id="预定义的values">预定义的Values</h3>
<p>Values通过模板中<code>.Values</code>对象可访问的<code>values.yaml</code>文件（或者通过 <code>--set</code> 参数)提供，
但可以模板中访问其他预定义的数据片段。</p>
<p>以下值是预定义的，对每个模板都有效，并且可以被覆盖。和所有值一样，名称 <em>区分大小写</em>。</p>
<ul>
<li><code>Release.Name</code>: 版本名称(非chart的)</li>
<li><code>Release.Namespace</code>: 发布的chart版本的命名空间</li>
<li><code>Release.Service</code>: 组织版本的服务</li>
<li><code>Release.IsUpgrade</code>: 如果当前操作是升级或回滚，设置为true</li>
<li><code>Release.IsInstall</code>: 如果当前操作是安装，设置为true</li>
<li><code>Chart</code>: <code>Chart.yaml</code>的内容。因此，chart的版本可以从 <code>Chart.Version</code> 获得，
并且维护者在<code>Chart.Maintainers</code>里。</li>
<li><code>Files</code>: chart中的包含了非特殊文件的类图对象。这将不允许您访问模板，
但是可以访问现有的其他文件（除非被<code>.helmignore</code>排除在外）。
使用<code>{{ index .Files &quot;file.name&quot; }}</code>可以访问文件或者使用<code>{{.Files.Get name }}</code>功能。
您也可以使用<code>{{ .Files.GetBytes }}</code>作为<code>[]byte</code>访问文件内容。</li>
<li><code>Capabilities</code>: 包含了Kubernetes版本信息的类图对象。(<code>{{ .Capabilities.KubeVersion }}</code>)
和支持的Kubernetes API 版本(<code>{{ .Capabilities.APIVersions.Has &quot;batch/v1&quot; }}</code>)</li>
</ul>
<p><strong>注意：</strong> 任何未知的<code>Chart.yaml</code>字段会被抛弃。在<code>Chart</code>对象中无法访问。因此，
<code>Chart.yaml</code>不能用于将任意结构的数据传递到模板中。不过values文件可用于此。</p>
<h3 id="values文件">Values文件</h3>
<p>考虑到前面部分的模板，<code>values.yaml</code>文件提供的必要值如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">imageRegistry</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;quay.io/deis&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">dockerTag</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;latest&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">pullPolicy</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;Always&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;s3&#34;</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>values文件被定义为YAML格式。chart会包含一个默认的<code>values.yaml</code>文件。
Helm安装命令允许用户使用附加的YAML values覆盖这个values：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#009;font-weight:bold">$</span> helm install --generate-name --values<span style="color:#555">=</span>myvals.yaml wordpress
</span></span></code></pre></div><p>以这种方式传递值时，它们会合并到默认的values文件中。比如，<code>myvals.yaml</code>文件如下：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;gcs&#34;</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>当在chart中这个值被合并到<code>values.yaml</code>文件中时，生成的内容是这样：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">imageRegistry</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;quay.io/deis&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">dockerTag</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;latest&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">pullPolicy</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;Always&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;gcs&#34;</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>注意只有最后一个字段会覆盖。</p>
<p><strong>注意：</strong> chart包含的默认values文件 <em>必须</em> 被命名为<code>values.yaml</code>。不过在命令行指定的文件可以是其他名称。</p>
<p><strong>注意：</strong> 如果<code>helm install</code>或<code>helm upgrade</code>使用了<code>--set</code>参数，这些值在客户端会被简单地转换为YAML。</p>
<p><strong>注意：</strong> 如果values 文件存在任何必需的条目，它们会在chart模板中使用
<a href="https://helm.sh/zh/docs/howto/charts_tips_and_tricks" target="_blank">'required'
函数</a> 声明为必需的。</p>
<p>然后使用模板中的<code>.Values</code>对象就可以任意访问这些值了：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>ReplicationController<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>deis<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">app.kubernetes.io/managed-by</span>:<span style="color:#bbb"> </span>deis<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">replicas</span>:<span style="color:#bbb"> </span><span style="color:#f60">1</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">selector</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">template</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">labels</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#309;font-weight:bold">app.kubernetes.io/name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">serviceAccount</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">containers</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>deis-database<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">image</span>:<span style="color:#bbb"> </span>{{<span style="color:#bbb"> </span>.Values.imageRegistry }}/postgres:{{ .Values.dockerTag }}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">imagePullPolicy</span>:<span style="color:#bbb"> </span>{{<span style="color:#bbb"> </span>.Values.pullPolicy }}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">ports</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- <span style="color:#309;font-weight:bold">containerPort</span>:<span style="color:#bbb"> </span><span style="color:#f60">5432</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#309;font-weight:bold">env</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>DATABASE_STORAGE<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">              </span><span style="color:#309;font-weight:bold">value</span>:<span style="color:#bbb"> </span>{{<span style="color:#bbb"> </span>default &#34;minio&#34; .Values.storage }}<span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="范围依赖和值">范围，依赖和值</h3>
<p>Values文件可以声明顶级chart的值，以及<code>charts/</code>目录中包含的其他任意chart。
或者换个说法，values文件可以为chart及其任何依赖项提供值。比如，上面示范的WordPress chart同时有
<code>mysql</code> 和 <code>apache</code> 作为依赖。values文件可以为以下所有这些组件提供依赖：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">title</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;My WordPress Site&#34;</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Sent to the WordPress template</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">mysql</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">max_connections</span>:<span style="color:#bbb"> </span><span style="color:#f60">100</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Sent to MySQL</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">password</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;secret&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">apache</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">port</span>:<span style="color:#bbb"> </span><span style="color:#f60">8080</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Passed to Apache</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>更高阶的chart可以访问下面定义的所有变量。因此WordPress chart可以用<code>.Values.mysql.password</code>访问MySQL密码。
但是低阶的chart不能访问父级chart，所以MySQL无法访问<code>title</code>属性。同样也无法访问<code>apache.port</code>。</p>
<p>Values 被限制在命名空间中，但是命名空间被删减了。因此对于WordPress chart，
它可以用<code>.Values.mysql.password</code>访问MySQL的密码字段。但是对于MySQL chart，值的范围被缩减了且命名空间前缀被移除了，
因此它把密码字段简单地看作<code>.Values.password</code>。</p>
<h4 id="全局values">全局Values</h4>
<p>从2.0.0-Alpha.2开始，Helm 支持特殊的&quot;global&quot;值。设想一下前面的示例中的修改版本：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">title</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;My WordPress Site&#34;</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Sent to the WordPress template</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">global</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">app</span>:<span style="color:#bbb"> </span>MyWordPress<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">mysql</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">max_connections</span>:<span style="color:#bbb"> </span><span style="color:#f60">100</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Sent to MySQL</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">password</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;secret&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">apache</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">port</span>:<span style="color:#bbb"> </span><span style="color:#f60">8080</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Passed to Apache</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>上面添加了<code>global</code>部分和一个值<code>app: MyWordPress</code>。这个值以<code>.Values.global.app</code>在 <em>所有</em> chart中有效。</p>
<p>比如，<code>mysql</code>模板可以以<code>{{.Values.global.app}}</code>访问<code>app</code>，同样<code>apache</code>chart也可以访问。
实际上，上面的values文件会重新生成为这样：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">title</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;My WordPress Site&#34;</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Sent to the WordPress template</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">global</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">app</span>:<span style="color:#bbb"> </span>MyWordPress<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">mysql</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">global</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">app</span>:<span style="color:#bbb"> </span>MyWordPress<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">max_connections</span>:<span style="color:#bbb"> </span><span style="color:#f60">100</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Sent to MySQL</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">password</span>:<span style="color:#bbb"> </span><span style="color:#c30">&#34;secret&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">apache</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">global</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">app</span>:<span style="color:#bbb"> </span>MyWordPress<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">port</span>:<span style="color:#bbb"> </span><span style="color:#f60">8080</span><span style="color:#bbb"> </span><span style="color:#09f;font-style:italic"># Passed to Apache</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>这提供了一种和所有的子chart共享顶级变量的方式，这在类似label设置<code>metadata</code>属性时会很有用。</p>
<p>如果子chart声明了一个全局变量，那这个变量会 <em>向下</em> 传递（到子chart的子chart），但不会 <em>向上</em> 传递到父级chart。
子chart无法影响父chart的值。</p>
<p>并且，父chart的全局变量优先于子chart中的全局变量。</p>
<h3 id="架构文件">架构文件</h3>
<p>有时候，chart容器可能想基于它们的values值定义一个结构，这可以在<code>values.schema.json</code>文件中定义一个架构实现。
架构使用
<a href="https://json-schema.org/" target="_blank">JSON 架构</a>表示。看起来像这样：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#309;font-weight:bold">&#34;$schema&#34;</span>: <span style="color:#c30">&#34;https://json-schema.org/draft-07/schema#&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#309;font-weight:bold">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#309;font-weight:bold">&#34;image&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;description&#34;</span>: <span style="color:#c30">&#34;Container Image&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;properties&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#309;font-weight:bold">&#34;repo&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;string&#34;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#309;font-weight:bold">&#34;tag&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;string&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;object&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#309;font-weight:bold">&#34;name&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;description&#34;</span>: <span style="color:#c30">&#34;Service name&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;string&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#309;font-weight:bold">&#34;port&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;description&#34;</span>: <span style="color:#c30">&#34;Port&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;minimum&#34;</span>: <span style="color:#f60">0</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;integer&#34;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#309;font-weight:bold">&#34;protocol&#34;</span>: {
</span></span><span style="display:flex;"><span>      <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;string&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#309;font-weight:bold">&#34;required&#34;</span>: [
</span></span><span style="display:flex;"><span>    <span style="color:#c30">&#34;protocol&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#c30">&#34;port&#34;</span>
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>  <span style="color:#309;font-weight:bold">&#34;title&#34;</span>: <span style="color:#c30">&#34;Values&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#309;font-weight:bold">&#34;type&#34;</span>: <span style="color:#c30">&#34;object&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>这个架构会应用values值并验证它。当执行以下任意命令时会进行验证：</p>
<ul>
<li><code>helm install</code></li>
<li><code>helm upgrade</code></li>
<li><code>helm lint</code></li>
<li><code>helm template</code></li>
</ul>
<p>一个符合此架构要求的<code>values.yaml</code>文件示例如下所示：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>frontend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">protocol</span>:<span style="color:#bbb"> </span>https<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">port</span>:<span style="color:#bbb"> </span><span style="color:#f60">443</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>注意这个架构被应用到了最终的 <code>.Values</code> 对象，而不仅仅是<code>values.yaml</code>文件。
这意味着下面的<code>yaml</code>文件是有效的，给定的chart是用下面显示的适当的<code>--set</code>选项安装的：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>frontend<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">protocol</span>:<span style="color:#bbb"> </span>https<span style="color:#bbb">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#aaa">helm install --set port=443
</span></span></span></code></pre></div><p>此外，最终的<code>.Values</code>对象是根据<em>所有的</em>子chart架构检查。 这意味着父chart无法规避子chart的限制。
这也是逆向的 - 如果子chart的<code>values.yaml</code>文件无法满足需求，父chart<em>必须</em> 满足这些限制才能有效。</p>
<h3 id="参考">参考</h3>
<p>在编写模板，值和架构文件时，有几个标准的参考可以帮助您。</p>
<ul>
<li>
<a href="https://godoc.org/text/template" target="_blank">Go templates</a></li>
<li>
<a href="https://godoc.org/github.com/Masterminds/sprig" target="_blank">Extra template functions</a></li>
<li>
<a href="https://yaml.org/spec/" target="_blank">The YAML format</a></li>
<li>
<a href="https://json-schema.org/" target="_blank">JSON Schema</a></li>
</ul>
<h2 id="用户自定义资源crd">用户自定义资源(CRD)</h2>
<p>Kubernetes提供了一种声明Kubernetes新类型对象的机制。使用CustomResourceDefinition（CRD），
Kubernetes开发者可以声明自定义资源类型。</p>
<p>Helm 3中,CRD被视为一种特殊的对象。它们被安装在chart的其他部分之前，并受到一些限制。</p>
<p>CRD YAML文件应被放置在chart的<code>crds/</code>目录中。
多个CRD(用YAML的开始和结束符分隔)可以被放置在同一个文件中。Helm会尝试加载CRD目录中 <em>所有的</em> 文件到Kubernetes。</p>
<p>CRD 文件 <em>无法模板化</em>，必须是普通的YAML文档。</p>
<p>当Helm安装新chart时，会上传CRD，暂停安装直到CRD可以被API服务使用，然后启动模板引擎，
渲染chart其他部分，并上传到Kubernetes。因为这个顺序，CRD信息会在Helm模板中的
<code>.Capabilities</code>对象中生效，并且Helm模板会创建在CRD中声明的新的实例对象。</p>
<p>比如，如果您的chart在<code>crds/</code>目录中有针对于<code>CronTab</code>的CRD，您可以在<code>templates/</code>目录中创建<code>CronTab</code>类型实例：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>crontabs/
</span></span><span style="display:flex;"><span>  Chart.yaml
</span></span><span style="display:flex;"><span>  crds/
</span></span><span style="display:flex;"><span>    crontab.yaml
</span></span><span style="display:flex;"><span>  templates/
</span></span><span style="display:flex;"><span>    mycrontab.yaml
</span></span></code></pre></div><p><code>crontab.yaml</code>文件必须包含没有模板指令的CRD:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CustomResourceDefinition<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>crontabs.stable.example.com<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">group</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">versions</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">served</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#309;font-weight:bold">storage</span>:<span style="color:#bbb"> </span><span style="color:#069;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">scope</span>:<span style="color:#bbb"> </span>Namespaced<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">names</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">plural</span>:<span style="color:#bbb"> </span>crontabs<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">singular</span>:<span style="color:#bbb"> </span>crontab<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#309;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span></span></span></code></pre></div><p>然后模板<code>mycrontab.yaml</code>可以创建一个新的<code>CronTab</code>（照例使用模板）：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#309;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>stable.example.com<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>CronTab<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#309;font-weight:bold">name</span>:<span style="color:#bbb"> </span>{{<span style="color:#bbb"> </span>.Values.name }}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#309;font-weight:bold">spec</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">   </span><span style="color:#09f;font-style:italic"># ...</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>Helm在安装<code>templates/</code>内容之前会保证<code>CronTab</code>类型安装成功并对Kubernetes API可用。</p>
<h3 id="crd的限制">CRD的限制</h3>
<p>不像大部分的Kubernetes对象，CRD是全局安装的。因此Helm管理CRD时会采取非常谨慎的方式。
CRD受到以下限制：</p>
<ul>
<li>CRD从不重新安装。 如果Helm确定<code>crds/</code>目录中的CRD已经存在（忽略版本），Helm不会安装或升级。</li>
<li>CRD从不会在升级或回滚时安装。Helm只会在安装时创建CRD。</li>
<li>CRD从不会被删除。自动删除CRD会删除集群中所有命名空间中的所有CRD内容。因此Helm不会删除CRD。</li>
</ul>
<p>希望升级或删除CRD的操作员应该谨慎地手动执行此操作。</p>
<h2 id="使用helm管理chart">使用Helm管理Chart</h2>
<p><code>helm</code>工具有一些命令用来处理chart。</p>
<p>它可以为您创建一个新chart：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#009;font-weight:bold">$</span> helm create mychart
</span></span><span style="display:flex;"><span><span style="color:#aaa">Created mychart/
</span></span></span></code></pre></div><p>编辑了chart之后，<code>helm</code>能为您把它打包成一个chart存档：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#009;font-weight:bold">$</span> helm package mychart
</span></span><span style="display:flex;"><span><span style="color:#aaa">Archived mychart-0.1.-.tgz
</span></span></span></code></pre></div><p>您也可以使用<code>helm</code> 帮您找到chart的格式或信息的问题：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span><span style="color:#009;font-weight:bold">$</span> helm lint mychart
</span></span><span style="display:flex;"><span><span style="color:#aaa">No issues found
</span></span></span></code></pre></div><h2 id="chart仓库">Chart仓库</h2>
<p><em>chart仓库</em> 是一个HTTP服务器，包含了一个或多个打包的chart。当<code>helm</code>用来管理本地chart目录时，
共享chart时，首选的机制就是使用chart仓库。</p>
<p>任何可以服务于YAML文件和tar文件并可以响应GET请求的HTTP服务器都可以用做仓库服务器。
Helm 团队已经测试了一些服务器，包括激活websit模组的Google Cloud 存储，以及使用website的S3。</p>
<p>仓库的主要特征存在一个名为 <code>index.yaml</code> 的特殊文件，文件中包含仓库提供的包的完整列表，
以及允许检索和验证这些包的元数据。</p>
<p>在客户端，仓库使用<code>helm repo</code>命令管理。然而，Helm不提供上传chart到远程仓库的工具。
这是因为这样做会给执行服务器增加大量的必要条件，也就增加了设置仓库的障碍。</p>
<h2 id="chart-starter-包">Chart Starter 包</h2>
<p><code>helm create</code>命令可以附带一个可选的 <code>--starter</code> 选项让您指定一个 &quot;starter chart&quot;。</p>
<p>Starter就只是普通chart，但是被放置在<code>$XDG_DATA_HOME/helm/starters</code>。作为一个chart开发者，
您可以编写被特别设计用来作为启动的chart。设计此类chart应注意以下考虑因素：</p>
<ul>
<li><code>Chart.yaml</code>会被生成器覆盖。</li>
<li>用户将希望修改此类chart的内容，所以文档应该说明用户如果做到这一点。</li>
<li>所有出现的<code>&lt;CHARTNAME&gt;</code>都会被替换为指定为chart名称，以便chart可以作为模板使用。</li>
</ul>
<p>当前增加一个chart的唯一方式就是拷贝chart到<code>$XDG_DATA_HOME/helm/starters</code>。在您的chart文档中，您可能需要解释这个过程。</p>


        <nav class="level prev-next">
          <div class="level-left level-item">
            
          </div>
          
          <div class="level-right level-item has-text-right">
            
            <a class="" href="https://zou-zongming.github.io/zh/docs/topics/charts_hooks/" title="Chart">
              <small class="heading">Next</small>
              <p class="title">Chart Hook →</p>
            </a>
            
          </div>
        </nav>
      </article>
    </section>
  </div>
</div>



<section class="container footer-links">
  <div class="columns clearfix">
    <dl class="column">
      <dt><a href="https://github.com/helm/helm">Helm Project</a></dt>
      <dd><a href="/blog">Blog</a></dd>
      <dd><a href="https://www.cncf.io/community/kubecon-cloudnativecon-events/">Events</a></dd>
      <dd><a href="/docs/intro/quickstart/">Quick Start Guide</a></dd>
      <dd><a href="https://github.com/cncf/foundation/blob/master/code-of-conduct.md">Code of Conduct</a></dd>
    </dl>

    <dl class="column">
      <dt><a href="https://hub.helm.sh">Charts</a></dt>
      <dd><a href="/docs/topics/charts/">Introduction</a></dd>
      <dd><a href="/docs/howto/charts_tips_and_tricks/">Chart tips &amp; tricks</a></dd>
      <dd><a href="/docs/chart_template_guide/">Developing Charts</a></dd>
      <dd><a href="https://hub.helm.sh">Search 800+ Charts</a> <i class="fa fa-external"></i></dd>
    </dl>

    <dl class="column">
      <dt><a href="https://github.com/helm/community/blob/main/communication.md">Development</a></dt>
      <dd><a href="https://kubernetes.slack.com/messages/C51E88VDG">#helm-dev</a> <em>(slack)</em></dd>
      <dd><a href="https://github.com/helm/helm/blob/main/CONTRIBUTING.md">Contribution Guide</a></dd>
      <dd><a href="https://github.com/helm/helm/blob/main/OWNERS">Maintainers</a></dd>
      <dd><a href="https://github.com/helm/community/blob/main/communication.md#meetings">Weekly Meetings</a></dd>
    </dl>

    <dl class="column">
      <dt><a href="https://github.com/helm/community">Community</a></dt>
      <dd><a href="https://kubernetes.slack.com/messages/C0NH30761" title="#helm-users on Slack">#helm-users</a> <em>(slack)</em></dd>
      <dd><a href="https://lists.cncf.io/g/cncf-helm/topics">Mailing List</a></dd>
      <dd><a href="https://github.com/cncf/artwork/tree/master/projects/helm">Logos</a> &amp; <a href="https://github.com/helm/community/tree/main/art">Art</a></dd>
      <dd><a href="https://twitter.com/helmpack">Twitter</a></dd>
    </dl>
  </div>

  <div class="columns has-text-left cncf-wrap">
    <div class="column is-two-thirds">
      <a href="https://www.cncf.io/" title="Cloud Native Computing Foundation" target="_blank">
        <p class="lead">我们是 CNCF 的毕业项目。</p>
      </a>
    </div>

    <div class="column is-one-third has-text-right">
      <a href="https://www.cncf.io/" title="Cloud Native Computing Foundation" target="_blank">
        <img src="/img/cncf-white.svg" alt="We are a Cloud Native Computing Foundation project" class="">
      </a>
    </div>
  </div>

  <hr />

  <div class="copyright">
    <p>
      &copy; Helm Authors 2024 | Documentation distributed under <a href="https://creativecommons.org/licenses/by/4.0">CC-BY-4.0</a>
    </p>

    <p>
      &copy; 2024 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a> page.
    </p>
  </div>
</section>



    
    

    











































<script src="/js/jquery.min.91911616059b1420d1a7e93cdb684177d9a8bcef473731743e5f72a796662698.js" integrity="sha256-kZEWFgWbFCDRp&#43;k822hBd9movO9HNzF0Pl9yp5ZmJpg="></script>




<script src="/js/bundle.min.019ebc0ad20ee895d8c4abd8ac9285f0dff63d29231c6ace4e5d022ea590e038.js" integrity="sha256-AZ68CtIO6JXYxKvYrJKF8N/2PSkjHGrOTl0CLqWQ4Dg="></script>



<script async src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js" onload="docsearch({
  apiKey: '8bca76b0664b04581dc9f9854e844a90',
  indexName: 'helm',
  inputSelector: '#q',
  debug: false // Set debug to true if you want to inspect the dropdown
  })"></script>


    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42867143-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
